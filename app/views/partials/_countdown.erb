<% days  = date - DateTime.now %>
<% hours =(days-days.floor)*24.0 %>
<% minutes =(hours - hours.floor) * 60 %>
<% seconds = (minutes - minutes.floor) * 60 %>

<div class="container countdown">
	<div class="row ">
		<div class="col-xs-12 col-sm-6 col-lg-3 countdown-block">
			<div class="number days"><%= "%02d" % days.floor%></div>
			<div class="label"><%=t("course.days")%></div>
		</div>
		<div class="col-xs-12 col-sm-6 col-lg-3 countdown-block">
			<div class="number hours"><%="%02d" % hours.floor%></div>
			<div class="label"><%=t("course.hours")%></div>
		</div>
		<div class="col-xs-12 col-sm-6 col-lg-3 countdown-block">
			<div class="number minutes"><%="%02d" % minutes.floor%></div>
			<div class="label"><%=t("course.minutes")%></div>
		</div>
		<div class="col-xs-12 col-sm-6 col-lg-3 countdown-block">
			<div class="number seconds"><%="%02d" % seconds.floor%></div>
			<div class="label"><%=t("course.seconds")%></div>
		</div>
	</div>
</div>

<script>
	$(function(){
		function pad(n, width, z) {
		  z = z || '0';
		  n = n + '';
		  return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;
		}
		var interval = setInterval(function(){
			var now = new Date();
			var scheduled = new Date("<%=date%>");
			var remaining = (scheduled - now) / 1000 / 60 / 60 / 24 ;
			if (remaining < 0) {
				clearInterval(interval);
				$('.countdown .days').html("00");
				$('.countdown .hours').html("00");
				$('.countdown .minutes').html("00");
				$('.countdown .seconds').html("00");
				window.location.reload();
			} else {
				var days = remaining
				var hours = (days - Math.floor(remaining)) * 24;
				var minutes = (hours - Math.floor(hours)) * 60;
				var seconds = (minutes - Math.floor(minutes)) * 60;

				var days = Math.max(Math.floor(days),0);
				var hours = Math.max(Math.floor(hours),0);
				var minutes = Math.max(Math.floor(minutes),0);
				var seconds = Math.max(Math.floor(seconds),0);

				$('.countdown .days').html(pad(days,2));
				$('.countdown .hours').html(pad(hours,2));
				$('.countdown .minutes').html(pad(minutes,2));
				$('.countdown .seconds').html(pad(seconds,2));
			}

		}, 1000);
	});
</script>